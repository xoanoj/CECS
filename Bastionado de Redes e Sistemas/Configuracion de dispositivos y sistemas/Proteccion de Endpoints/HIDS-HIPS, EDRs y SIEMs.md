Parte de [[Proteccion de Endpoints]]

De forma xenérica, un IDS ou Sistema de Detección de Intrusos (ou Intrusións) é unha fe-rramenta de seguridade que tenta detectar ou monitorizar os eventos ocorridos nun deter-minado sistema informático en busca de intentos de comprometer a seguridade do devan-dito sistema. Diferénciase dun IPS ou Sistema de Prevención de Intrusos (ou Intrusións)en que este último é capaz de tomar medidas para paliar o dano que a ameaza detectadapuidese realizar, mentres que o primeiro deles unicamente é capaz de detectar a ameazasen realizar ningún tipo de acción para paliala. Os IDSs baséanse nun serie de patróns ou regras previamente definidas que impliquencalquera tipo de actividade sospeitosa.Os IDSs achegan á nosa seguridade unha capacidade de prevención e de alerta anticipa-da ante calquera actividade sospeitosa. Non están deseñados para deter un ataque, aíndaque si poden xerar certos tipos de resposta ante estes.Principalmente existen dous tipos de IDSs, os baseados en rede (Net IDS, NIDS) e osbaseados en Host (Host IDS, HIDS). Como se pode deducir, os primeiros basearanse enanalizar e monitorizar o tráfico de rede en busca de comportamentos anómalos, e os se-gundos centraranse na monitorización de endpoints ou equipos individuais

OsHIDS/HIPS protexen un endpoint ou equipo final, xa sexa este un host ou un servidor.Monitorizan gran cantidade de eventos, analizando actividades cunha gran precisión, de-terminando desta maneira que procesos e usuarios están involucrados nunha determinadaacción. Solicitan información do sistema como ficheiros, logs, recursos, etc, para a súaposterior análise en busca de posibles incidencias.Este tipo de IDSs pódense dividir, á súa vez, en tres subcategorías:

- Verificadores de integridade do sistema.(SIVs) Un verificador de integridade non émáis que un mecanismo encargado de monitorizar arquivos dunha máquina en busca deposibles modificacións non autorizadas, por norma xeral rootkits deixados por un intru-so. Un exemplo de verrificador de integridade en sistemas GNU/Linux é Tripwire e ensistemas windows SFC.
- Monitores de rexistros. Estes sistemas monitorizan os arquivos de log xerados polosprogramas dunha máquina en busca de patróns que poidan indicar un ataque ou unhaintrusión. Un exemplo de monitor de rexistros pode ser swatch ou logwatch, e mesmodentro desta categoría podemos incluír os pequenos shellscripts que moitos administra-dores de sistemas realizan para comprobar periodicamente os arquivos de log dos seusservidores
- Sistemas de deception. Os sistemas de deception ou tarros de mel (honeypots), sonmecanismos encargados de simular servizos con problemas de seguridade de forma queun ciberdelincuente pense que realmente o problema pódese aproveitar para acceder aun sistema, cando realmente estase aproveitando para rexistrar todas as súas activida-des


Os sistemas EDR (Endpoint Detection and Response) poden verse como unha evoluciónou fusión dos sistemas antivirus e os HIDS mellorada coa incorporación de novos me-canismos para a detección de ameazas avanzadas como pode ser o machine learning.Algúns exemplos de ameazas que os anteriores sistemas non poden detectar facilmentee un EDR si, poden ser:

- Ataques exitosos de phishing. Un cibercriminal rouba as nosas credenciais e accedeaos nosos sistemas de forma lexítima. Actividades como tratar de elevar privilexios oumoverse lateralmente a outros endpoints deixará un rastro que non poderá ser detectadopolo noso antivirus.
- Documentos de Office con macros maliciosas embebidas ou PDFs que conteñancódigo javascript malicioso. O antivirus comproba só o documento inicial e non actúase lanza un script para descargar malware. O malware podería entón axexar en segundoplano sen ser detectado, infectar ao usuario e moverse pola rede.
- Malware sen arquivos (fileless). O cibercriminal carga e executa un código maliciosoenteiramente desde a memoria do equipo sen afectar o sistema de arquivos. Como nonhai ningún arquivo que analizar, o antivirus non detectará actividade sospeitosa.
- Malware altamente polimórfico. Os virus polimórficos van cambiando de forma con-tinúa o seu comportamento para evitar ser detectados por un antivirus.

Agora xa se está a falar de sistemas XDR no canto de sistemas EDR. A diferenza reside enque, mentres que un sistema EDR recompila e correlaciona as actividades que se sucedenen varios endpoints, XDR amplía o alcance da detección co fin de proporcionar detección,análise e resposta non só nos endpoints, senón tamén nas redes, servidores, cargas de tra-ballo na nube, SIEM e moito máis

Un Sistema de xestión de eventos e información de seguridade (SIEM-Security Informa-tion and Event Management) é unha solución software que agrega e analiza a actividadede diferentes recursos en toda a infraestrutura de TI dunha organización. Un SIEM recom-pila datos de seguridade de dispositivos de rede, servidores, controladores de dominio emáis. Logo almacena, normaliza, agrega e aplica análise a eses datos, o que axuda aosequipos de seguridade a detectar ameazas, administrar a resposta a incidentes e realizarunha investigación forense

Os sistemas SIEM teñen un control total sobre todos os eventos que suceden na empresapara poder detectar calquera tendencia ou patrón fóra do común e así actuar de forma in-mediata. SIEM é a evolución de dúas tecnoloxías de seguridade anteriores

- Xestores de eventos de seguridade (SEM). Detectan patróns de acceso fóra do comúnen tempo real. 
- Xestores de información de seguridade (SIM). Centralización dos rexistros de segurida-de para interpretalos e almacenalos en tempo real, facilitando a actuación inmediata.

As funcións principais que realiza un sistema SIEM son a de almacenar e interpretar os re-xistros. Este proceso realízase en tempo real achegando desta forma un alto grao de reac-ción para poder impedir ou solucionar calquera incidente relacionado coa seguridade in-formática. Recompílase toda a información de forma centralizada nunha base de datospara poder realizar unha análise profunda e así detectar tendencias e patróns de comporta-mento que permitan diferenciar aqueles que non sexan habituais.